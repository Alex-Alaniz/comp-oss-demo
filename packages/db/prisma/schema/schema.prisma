generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters", "postgresqlExtensions", "prismaSchemaFolder"]
  binaryTargets   = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model ApiKey {
  id             String       @id @default(cuid())
  name           String
  key            String       @unique
  salt           String?
  createdAt      DateTime     @default(now())
  expiresAt      DateTime?
  lastUsedAt     DateTime?
  organizationId String
  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  isActive       Boolean      @default(true)

  @@index([organizationId])
  @@index([key])
}

model AuditLog {
  id             String       @id @default(cuid())
  timestamp      DateTime     @default(now())
  userId         String
  organizationId String
  data           Json
  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  user           User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([organizationId])
}

enum Departments {
  none
  admin
  gov
  hr
  it
  itsm
  qms
}

enum Frequency {
  monthly
  quarterly
  yearly
}
